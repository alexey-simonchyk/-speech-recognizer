package com.bsuir.speech_recognizer.hmm;

import com.bsuir.speech_recognizer.math.MathCommon;
import com.bsuir.speech_recognizer.mfcc.MfccValue;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;

public class SoundMap {

    public SoundMap() {
        double[][] tempA = {
                {4.40575276916302, 1.299174614963456, 7.954634001366063, 1.428934721568377, 7.058213188576605, 1.263842969929835, 5.4815077481027386, 0.8968905867812993, 3.4315950236823634, 0.4576287031392019, 1.1646315695336114, -1.0564005463467573E-14},
                {2.882822076500543, 2.55653269479106, 7.4363429313595315, 2.1400039800137867, 6.778944220557275, 1.7739157532718242, 5.298396517045941, 1.2431419655146756, 3.3229501660654304, 0.6343442498782419, 1.1283614746345838, -1.2949265081225231E-14},
                {3.3535036678070416, 2.637625321925304, 7.966106885334782, 2.1967329050022504, 7.234773343246616, 1.8192016049841921, 5.649197168586165, 1.2743613825129754, 3.543939517375776, 0.6503026250701337, 1.2038150841381303, -1.3581446196870837E-14},
                {2.764476841319485, 2.9321117935906416, 7.650502257649061, 2.3412156264759814, 7.008899128010679, 1.921173106077731, 5.481631870184861, 1.3442731059369284, 3.439440480948698, 0.6862093376144242, 1.1682579744337345, -1.3985954066466556E-14},
                {3.4998424203855705, 2.438468191557447, 7.923675237735051, 2.080816054474025, 7.17878677574445, 1.7326015075902679, 5.602544475555255, 1.2149807664164638, 3.5137329721556565, 0.6199108747696602, 1.193391678712115, -1.3103335143721983E-14},
                {4.066634914882251, 1.7284288443990579, 7.9067119228317875, 1.677042109935098, 7.077159828307293, 1.4392280467065528, 5.508581261739673, 1.0150117568614436, 3.4512800362875784, 0.5177184329630228, 1.1716645023804855, -1.1495409029795898E-14},
                {2.9079049765851557, 2.775028600455505, 7.624229884691447, 2.2599130053120446, 6.969053026510739, 1.8604151999447578, 5.449045227438655, 1.302167211172221, 3.4185933893847853, 0.6645371279941925, 1.1610979328843374, -1.3607656113436173E-14},
                {3.4489888824174684, 2.017342560356371, 7.557189882587274, 1.8346207584294025, 6.815655203746283, 1.5522259684848683, 5.314516862548066, 1.0919786252975254, 3.3305582032061665, 0.5570814118353357, 1.130640083485442, -1.1846409289012904E-14},
                {3.4876679029675772, 2.6000202054632116, 8.04465329915594, 2.1808872086931204, 7.297204193685239, 1.8077054860980835, 5.696699729072523, 1.2663455826139343, 3.573779641359773, 0.6461476161428542, 1.213992593034444, -1.3560446834707232E-14},
                {3.319157662921036, 2.2475240977164486, 7.584607343831298, 1.9730827516471217, 6.867260421292432, 1.652500465141129, 5.360176863161185, 1.1599120200861486, 3.360654755434429, 0.5916814177084521, 1.1410822827178035, -1.2380535069529741E-14},
                {3.8008657053471233, 1.8528162847853822, 7.749122979147475, 1.7473261484591514, 6.95822868270876, 1.4896098080376148, 5.420431115285117, 1.049196362860036, 3.3965117420684487, 0.5351629476605342, 1.1530624502350446, -1.163845861379163E-14},
                {2.703307916568499, 2.8603761724800676, 7.508730588719971, 2.3039747603669, 6.880862439868519, 1.8925795254969326, 5.382760921218203, 1.3243463877177284, 3.3771570911829847, 0.6759362952282838, 1.1469931508611493, -1.3700040470319181E-14},
                {2.849212304369624, 2.656918270155125, 7.486565305120973, 2.194223529683242, 6.834933560900749, 1.813285634807392, 5.343333901046533, 1.2701137834451846, 3.351574806175748, 0.6481649984324409, 1.138170976662232, -1.3220275551300717E-14}
        };
        SoundMapEntry soundMapEntryA = new SoundMapEntry();
        ArrayList<MfccValue> mfccValuesA = soundMapEntryA.getValues();
        for (double[] temp : tempA) {
            mfccValuesA.add(new MfccValue(temp));
        }
        values.put("a", soundMapEntryA);



        double[][] tempD = {
                {4.117844333814862, 1.6997907398050476, 7.9546386675294105, 1.657281190905128, 7.113536678728539, 1.4257683837351465, 5.535101888373269, 1.0061858973267213, 3.467624549850999, 0.5132875187013871, 1.1772004730574621, -1.1474695712017678E-14},
                {3.618783562427908, 1.7772044153923114, 7.529560019499785, 1.688783645308325, 6.767919924743172, 1.443683032121673, 5.27281673200197, 1.0178403312403128, 3.303071093699459, 0.5192271959221618, 1.121090039375602, -1.1297278481093125E-14},
                {3.6471924479668494, 2.5489713178533693, 8.154923403586976, 2.145691533359508, 7.388566846507612, 1.7809223770712617, 5.765635864280064, 1.2480930563617187, 3.616756766896942, 0.6368523719399465, 1.2285993690028385, -1.3550197104339136E-14},
                {3.611027523111971, 1.674000858623581, 7.423186026259618, 1.6348049086427716, 6.664261323626375, 1.40392588608084, 5.191692705145655, 0.9903822160133791, 3.251805883413818, 0.5051053351201997, 1.103570132081132, -1.0969558253874868E-14},
                {3.824980571569603, 1.8759928116642444, 7.781037668641099, 1.761642561992523, 6.9890520253100465, 1.4996360488111233, 5.444880797720266, 1.0559045819295947, 3.4120568551851793, 0.538563945323214, 1.1583854827224163, -1.1718093779806423E-14},
                {3.114983719221909, 2.3297304910495202, 7.477895863793245, 2.01464603497382, 6.785486358697583, 1.683181161047726, 5.298536561831615, 1.1811801670935418, 3.3220686147196394, 0.6026415382766585, 1.1279416343985464, -1.247452117379645E-14},
                {3.4351328885997456, 2.6354729110537045, 8.032642871125866, 2.199296217542896, 7.290787621293679, 1.8214366560974051, 5.692237970245305, 1.2758639139117682, 3.5710526632458452, 0.6510495898452275, 1.2130729339826, -1.3630266483137395E-14},
                {3.490989707900704, 2.694898172529242, 8.14108876707704, 2.2331397118548004, 7.38977039564254, 1.8467275211351217, 5.769237781088462, 1.2932298162032676, 3.6196978709797643, 0.6599463827198826, 1.2296977921122882, -1.3857990279536069E-14},
                {3.5332689061106293, 2.468936282204773, 7.987418990629385, 2.096082649380966, 7.237041512421618, 1.7439100107175207, 5.647651338143958, 1.2228126686640552, 3.542153018741976, 0.6239452299781025, 1.2030934367683757, -1.3229262123719857E-14},
                {3.1649085392187577, 2.4311275548292492, 7.596654492338617, 2.072062432396033, 6.9006416437205775, 1.7245701648967628, 5.389291890262073, 1.2093450124554108, 3.37961386188781, 0.6170277578866225, 1.1476299143662425, -1.2806577883577436E-14},
                {3.9699216241463806, 1.9292939448478732, 7.98284136545687, 1.7859006509865538, 7.1685400593066095, 1.5177838129905674, 5.582985975835101, 1.068658757756247, 3.4988735757371066, 0.545183335041503, 1.1879968667413128, -1.2019537714443788E-14},
                {3.928300418512991, 1.835157974509848, 7.844860166091574, 1.7351308701534087, 7.040817869481533, 1.4794405418007899, 5.483813477897454, 1.0420761232484212, 3.43629563228672, 0.5315062088458213, 1.1666181937692572, -1.1687493240161846E-14},
                {4.559389477353674, 1.3062155565832296, 8.116809926129939, 1.4300809381143806, 7.198056988952697, 1.2649631384018765, 5.588571382293127, 0.8978412027988507, 3.4988091115700515, 0.45816442031976257, 1.1875457811166137, -1.072449890797424E-14},
                {3.2941918199292886, 2.4954748447456905, 7.77055129738963, 2.107072334656659, 7.057995657645046, 1.7500735162333783, 5.511289579702474, 1.2268210843699778, 3.4565481328262355, 0.6259827686757894, 1.1739010344771437, -1.3104571774267273E-14},
                {4.47178473129652, 1.3379798177372901, 8.036119424729705, 1.4517644548158417, 7.134033105523024, 1.279725657881389, 5.540984693314793, 0.907508971130417, 3.46926123126093, 0.4630143616653003, 1.1775113468910228, -1.0723836171581293E-14},
                {3.6039330204032045, 1.6626667771993278, 7.406712048279339, 1.628494562379275, 6.648774664520789, 1.399410297446686, 5.1794665052449815, 0.9873743098733436, 3.244030006686327, 0.5035847447410765, 1.1009065345185745, -1.0928528096093012E-14},
                {3.64779438697047, 2.7211198752563264, 8.304419521961437, 2.2532722268782392, 7.531111582632036, 1.862244135808369, 5.878321821302455, 1.3038083128693512, 3.68848437411606, 0.6653281728341873, 1.2531917637861323, -1.405394221979042E-14},
                {3.299848460611242, 1.8181950500827329, 7.255542347339229, 1.7201527932799143, 6.534322442047801, 1.4678526091661137, 5.0946540355808105, 1.034220467208384, 3.191468531424519, 0.5275283387477839, 1.0830833348214526, -1.1138721672226937E-14},
                {3.428558751196874, 1.8893471936898787, 7.430658752148162, 1.7630955621952906, 6.691962876277019, 1.4997646642779427, 5.217104364094417, 1.0560305184414593, 3.2688084852261508, 0.5386694287224709, 1.1095123013245078, -1.1448285335421302E-14},
                {3.37118016207796, 1.9369362841305167, 7.4134340344526315, 1.791171599089513, 6.68248899385352, 1.5204103658692705, 5.210879822503536, 1.0701177870425345, 3.2651357747028813, 0.5458652619836174, 1.1082912286928233, -1.1538428498850244E-14},
                {3.8186187908839693, 1.9164502011237885, 7.819890934384698, 1.781662415075048, 7.027085581239836, 1.5144789777734329, 5.474570108818675, 1.0662043542098134, 3.430793977098508, 0.5438749988700418, 1.1647858128574309, -1.1845436110245835E-14},
                {3.037921379832961, 2.304244372300635, 7.361860621361978, 2.0058385706051802, 6.6832264965989765, 1.6760972184224694, 5.22039617239545, 1.1759167694607902, 3.273096214914106, 0.5998427404171325, 1.1112562424337, -1.2312144065163392E-14},
                {3.5722986259990743, 2.188882806506621, 7.791621493025641, 1.9364859199884061, 7.037331975364065, 1.626387538305587, 5.488813641125596, 1.1423717630735444, 3.4410826647429467, 0.5827817049225732, 1.1684605241746635, -1.2432785434814073E-14},
                {3.36378987575463, 1.6971890981407172, 7.210471875686878, 1.6478258045920198, 6.484561538391823, 1.4133116009342235, 5.054357372995682, 0.9967597790716514, 3.165590384076763, 0.5083610064845624, 1.0741781068247407, -1.0835217905814177E-14}
        };
        SoundMapEntry soundMapEntryD = new SoundMapEntry();
        ArrayList<MfccValue> mfccValuesD = soundMapEntryD.getValues();
        for (double[] temp : tempD) {
            mfccValuesD.add(new MfccValue(temp));
        }
        values.put("d", soundMapEntryD);




        double[][] tempV = {
                {3.478825449905415, 1.7801364594336735, 7.402010541919464, 1.688158249061663, 6.659941996054878, 1.4427227473846425, 5.190019238562309, 1.017202477853889, 3.25097995615437, 0.5189205952505652, 1.1033142849635735, -1.1194676160686039E-14},
                {3.815301204443805, 2.4527470497838237, 8.228590285133084, 2.089088913085043, 7.44227982887812, 1.738661003328176, 5.805041481623984, 1.2191161673435633, 3.6410968732432263, 0.6220242393638843, 1.2368420400599007, -1.3402908743755423E-14},
                {3.5852088915935445, 1.774351550890506, 7.483279703770945, 1.696222067803363, 6.724609155663366, 1.4503573413021749, 5.239820196267175, 1.022232008217834, 3.282555181367467, 0.5213858232011332, 1.1141299407219547, -1.1239615852401317E-14},
                {3.581808211165816, 2.4192521304406394, 7.9791441294632035, 2.071394402305028, 7.224155818425789, 1.7256046635251487, 5.6371432712036835, 1.210108123946117, 3.535457290855721, 0.6173943874756441, 1.200798214477624, -1.3107976121860666E-14},
                {3.55742184203078, 1.8112797585493308, 7.493489391891273, 1.7147245068511898, 6.738177188133629, 1.463783234669632, 5.250835345409664, 1.031488620247139, 3.289570487826375, 0.5261488790577885, 1.1165331713211049, -1.1333824423975477E-14},
                {4.308991103864168, 1.4982317829023155, 8.003232613181227, 1.5412985818906648, 7.1273663318288705, 1.3435474330017851, 5.540004060152704, 0.950724002305612, 3.4694976013403376, 0.4850549824622259, 1.1776944501217281, -1.106061642124169E-14},
                {3.59295597463276, 2.0292002090454426, 7.685831633193585, 1.8461515514781297, 6.927063533942743, 1.5606023485133935, 5.400737394192101, 1.0974654239900357, 3.3849887887779397, 0.5598184534997274, 1.149236154428582, -1.1981761814491444E-14},
                {3.5129692403153854, 2.6109226981495457, 8.092549866422258, 2.179420504632927, 7.341347264466387, 1.8060604654633563, 5.730438502895097, 1.2653691389593438, 3.594857295013277, 0.6457116451030721, 1.2211600677110008, -1.3635456464406911E-14},
                {2.9276373373189, 2.8158346260053273, 7.671881600054743, 2.2827662035738157, 7.015301711301102, 1.8768647018104083, 5.485509113026431, 1.3133441436414524, 3.441720544568259, 0.6702425531439373, 1.169011139772453, -1.3741502350383215E-14},
                {3.346771453368542, 2.237707918084779, 7.600324072824877, 1.9682165967367173, 6.879532356072879, 1.6489233035963298, 5.369465992660596, 1.1574277633224777, 3.366478537466704, 0.5903994791220029, 1.1430668504964225, -1.2371847314735865E-14},
                {3.4275829707443486, 2.0013783481763134, 7.514722856634185, 1.8288565624352495, 6.776904399772698, 1.548007078184101, 5.284767712645348, 1.0889358554815687, 3.311907014658294, 0.5554774873888554, 1.1242859795159126, -1.1770510379293502E-14},
                {4.126712649128652, 1.9244313014856118, 8.112626674852152, 1.786121148058804, 7.279555939603502, 1.5176583824123813, 5.668498280713263, 1.0683613326448338, 3.552742564358156, 0.5449760210735841, 1.20638499446422, -1.2120664826230291E-14},
                {3.697777646515951, 2.4659531059095086, 8.11075579854123, 2.106834365528117, 7.340130418664977, 1.7521985691775104, 5.727714753211567, 1.227962538892215, 3.5928921374980303, 0.6264195059581175, 1.2204574914621222, -1.3319941724309115E-14},
                {3.54162190313475, 2.1518487918575087, 7.721146612090647, 1.918644936949101, 6.9724704197923835, 1.613111543733098, 5.438671801888933, 1.1331034301559377, 3.4095269824839405, 0.5779886641965161, 1.1576930430831744, -1.2285628284329818E-14},
                {3.951125239663451, 1.8330702101975649, 7.905561119510075, 1.729114922845921, 7.0894557378202965, 1.4772269134274887, 5.5195690286378944, 1.0412976943561378, 3.458399866806644, 0.531264542074543, 1.1741172429567863, -1.1735661089696897E-14},
                {3.5013462213025814, 1.8686868170879278, 7.482686882753791, 1.7508736041693362, 6.7343614752951915, 1.490761771767927, 5.249188834559568, 1.0498853598062894, 3.2888734941213853, 0.5355303037115061, 1.1163423108078958, -1.1448349356166769E-14},
                {4.295479642509896, 1.4631902760626798, 7.987231554008028, 1.5155369569951151, 7.109162017848885, 1.3254023851197174, 5.524315854471733, 0.938840544688397, 3.4591578804426533, 0.4791109114501879, 1.1741063839117336, -1.097061212798009E-14},
                {3.5633406934252845, 2.1798026870468004, 7.762611269606863, 1.934460260027639, 7.011567484828587, 1.6245761603737754, 5.469305261540241, 1.1409162025258364, 3.4289163057859815, 0.5819814324039659, 1.164322869810137, -1.2384849023277262E-14},
                {4.215315067977691, 1.6777528263504005, 8.036439191220568, 1.6432283953201052, 7.180762392260221, 1.415855010791586, 5.585884719096634, 0.9995807900709874, 3.4993548983724443, 0.5099487495717259, 1.1879992367962218, -1.1497585556011675E-14},
                {3.4942631039191627, 1.803515988791764, 7.419857760713553, 1.7142842976037556, 6.673042893750006, 1.463807803868935, 5.200881428381715, 1.031417918448432, 3.258236397581124, 0.5260748574494536, 1.1058571861962474, -1.1247142382750991E-14},
                {3.6100481566181646, 2.31979875997378, 7.938158444822832, 2.009184471089968, 7.178530984057714, 1.6797189669687054, 5.5996961221986865, 1.1789163823525048, 3.5113081069375394, 0.6015000007699184, 1.1924800801808293, -1.2855558719973044E-14}
        };
        SoundMapEntry soundMapEntryV = new SoundMapEntry();
        ArrayList<MfccValue> mfccValuesV = soundMapEntryV.getValues();
        for (double[] temp : tempV) {
            mfccValuesV.add(new MfccValue(temp));
        }
        values.put("v", soundMapEntryV);
    }

    private static final double MFCC_WEIGHTS[] = {0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0};

    private HashMap<String, SoundMapEntry> values = new HashMap<>(0);

    public HashMap<String, SoundMapEntry> getValues() {
        return values;
    }

    public void setValues(HashMap<String, SoundMapEntry> values) {
        this.values = values;
    }

    public String getValue(MfccValue mfccValue) {
        double minDistance = Double.MAX_VALUE;
        String soundValue = null;

        for (Map.Entry<String, SoundMapEntry> entry : values.entrySet()) {
            SoundMapEntry soundMapEntry = entry.getValue();
            for (MfccValue value : soundMapEntry.getValues()) {

                double distance;
                distance = MathCommon.euclidianDistanceWithWeight(value.getValue(), mfccValue.getValue(), MFCC_WEIGHTS);

                if (distance < minDistance) {
                    soundValue = entry.getKey();
                    minDistance = distance;
                }
            }
        }

        return soundValue;
    }
}
